struct _light_pcapng *__copy_block(const struct _light_pcapng *pcapng, const light_boolean recursive)
{
	if (pcapng == NULL) {
		return NULL;
	}

	size_t body_length = pcapng->block_total_length - 2 * sizeof(pcapng->block_total_length) - sizeof(pcapng->block_type);
	struct _light_pcapng *pcopy = calloc(1, sizeof(struct _light_pcapng));
	size_t option_length = 0;

	pcopy->block_type = pcapng->block_type;
	pcopy->block_total_length = pcapng->block_total_length;
	pcopy->options = __copy_option(pcapng->options);
	option_length = __get_option_total_size(pcopy->options);
	body_length -= option_length;

	pcopy->block_body = calloc(body_length, 1);
	memcpy(pcopy->block_body, pcapng->block_body, body_length);

	if (recursive == LIGHT_TRUE) {
		pcopy->next_block = __copy_block(pcapng->next_block, recursive);
	}
	else {
		pcopy->next_block = NULL;
	}

	return pcopy;
}